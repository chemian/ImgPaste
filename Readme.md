# ImgPaste - 截图、贴图与OCR识别工具

一个轻量级桌面工具，支持通过快捷键快速截图、粘贴剪贴板图片并进行OCR文字识别，提升日常办公效率。

## 功能特点

- **快捷截图**：通过快捷键快速选取屏幕区域并显示截图
- **剪贴板贴图**：直接粘贴剪贴板中的图片并悬浮显示
- **OCR识别**：对截图或粘贴的图片进行文字识别并提取文本
- **图片操作**：
  - 鼠标拖拽移动图片位置
  - 滚轮缩放图片大小（范围：20%-500%）
  - 右键菜单支持复制、保存、OCR识别或关闭
  - 双击窗口快速关闭图片
- **悬浮窗口**：图片以悬浮窗口形式展示，始终保持在最上层
- **系统托盘**：程序最小化时常驻系统托盘，右键可退出程序
- **OCR结果窗口**：
  - 左侧显示带识别框的原图（支持滚轮缩放和重置）
  - 右侧显示识别出的文本
  - 一键复制识别结果到剪贴板

## 快捷键说明

| 快捷键组合 | 功能描述 |
|---------|--------|
| `Ctrl + Alt + A` | 截取屏幕区域并显示 |
| `Ctrl + Alt + Z` | 粘贴剪贴板中的图片并显示 |
| `Ctrl + Alt + X` | 截取屏幕区域并进行OCR识别 |

## 使用方法

### 截图操作
1. 按下 `Ctrl + Alt + A` 激活截图功能
2. 鼠标拖拽选择需要截取的区域
3. 松开鼠标后，截图将以悬浮窗口显示
4. 悬浮窗口操作：
   - 鼠标拖拽移动位置
   - 滚轮缩放图片大小（底部显示当前缩放比例）
   - 右键菜单可选择复制、保存、OCR识别或关闭
   - 双击窗口快速关闭

### 粘贴图片
1. 先将图片复制到剪贴板（如在网页或文件夹中复制图片）
2. 按下 `Ctrl + Alt + Z` 粘贴并显示图片
3. 操作方式与截图窗口相同

### OCR文字识别
1. **方式一**：对截图进行OCR
   - 按下 `Ctrl + Alt + X` 选择截图区域
   - 系统自动进行文字识别并显示结果窗口

2. **方式二**：对已显示的图片进行OCR
   - 右键点击图片窗口
   - 选择"OCR识别"选项
   - 系统将识别图片中的文字并显示结果

3. OCR结果窗口操作：
   - 左侧图片支持滚轮缩放和"重置缩放"按钮恢复原始大小
   - 右侧文本区域可直接查看识别结果
   - "复制到剪贴板"按钮可快速复制识别结果

## 安装说明

### 前提条件
- Python 3.7+
- 依赖库：`PyQt5`, `numpy`, `pynput`, `paddleocr`, `Pillow`

### 安装步骤

1. 安装依赖包
```bash
pip install -r requirements.txt
```

2. 运行程序
```bash
python ImgPaste.py
```

## 注意事项

- 首次运行时，PaddleOCR会自动下载模型文件，可能需要几分钟时间（取决于网络状况）
- OCR识别支持中英文混合文本，采用PP-OCRv5模型，识别准确率受图片清晰度和字体影响
- 程序运行时将在系统托盘显示图标，右键可选择退出程序
- 所有操作均在本地完成，不会上传图片或识别结果到云端，保护隐私安全
- 日志信息会显示详细操作过程，便于排查问题
- master分支official_models.zip为模型文件，解压到`C:\Users\{User}\.paddlex\official_models`


## 许可证

[MIT](LICENSE)